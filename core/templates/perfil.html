{% extends "base.html" %}
{% load static %}

{% block title %}Gifter’s{% endblock %}
{% block body_class %}index-page{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/perfil.css' %}">
{% endblock %}

{% block content %}
<div class="profile-header">
  <div class="profile-info">

    <!-- AVATAR (versión simple y robusta con <img>) -->
<!-- AVATAR (namespaced, a prueba de estilos globales) -->
<div
  class="g-avatar g-avatar--banner"
  style="background-image:url('{% if perfil.profile_picture %}{{ perfil.profile_picture.url }}{% else %}{% static "img/avatar-placeholder.png" %}{% endif %}');">
</div>


    <div class="user-details">
      <h2>{{ request.user.nombre }} {{ request.user.apellido }}</h2>
      <p class="text-muted">@{{ request.user.nombre_usuario }}</p>
      <p class="description">{{ request.user.perfil.bio|default:"Sin biografía aún." }}</p>
    </div>

    <div class="edit-profile">
      <a href="{% url 'perfil_editar' %}" class="btn-edit">Editar perfil ✎</a>
    </div>

  </div>

  <nav class="profile-nav">
    <ul>
      <li><a href="#" class="active" data-tab="wishlist">Wishlist</a></li>
      <li><a href="#" data-tab="recibidos">Regalos recibidos</a></li>
      <li><a href="#" data-tab="eventos">Eventos importantes</a></li>
      <li><a href="#" data-tab="amigos">Amigos</a></li>
    </ul>
  </nav>
</div>

<div class="profile-content">

  <!-- Wishlist -->
  <section id="wishlist" class="tab-content active">
    <h3>A “usuario” le encantaría</h3>
    <div class="gift-grid">
      <div class="gift-card">
        <img src="{% static 'img/logo.png' %}" alt="Producto">
        <div class="gift-info">
          <h4>Nestle Trencito</h4>
          <p>Chocolate de leche</p>
        </div>
        <div class="gift-actions">
          <button title="Marcar">✔</button>
          <button title="Ver">🔍</button>
          <button title="Copiar enlace">🔗</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Regalos recibidos -->
  <section id="recibidos" class="tab-content">
    <h3>“Usuario” ya recibió</h3>
    <div class="gift-grid">
      <div class="gift-card">
        <img src="{% static 'img/logo.png' %}" alt="Producto recibido">
        <div class="gift-info">
          <h4>Nestle Trencito</h4>
          <p>Chocolate de leche</p>
        </div>
        <div class="gift-actions">
          <button title="Ver" alt="emoji lupa">🔍</button>
          <button title="Copiar enlace" alt="emoji link">🔗</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Eventos importantes -->
  <section id="eventos" class="tab-content">
    <h3>Eventos importantes de “usuario”</h3>
    <div class="events-list">
      <div class="event-item">
        <div class="event-bar">
          <span class="event-name">Mi Cumpleaños</span>
        </div>
        <span class="event-date">12 de noviembre</span>
        <button class="event-edit" title="Editar">✎</button>
      </div>
      <div class="event-item">
        <div class="event-bar">
          <span class="event-name">Otro evento</span>
        </div>
        <span class="event-date">“fecha”</span>
        <button class="event-edit" title="Editar">✎</button>
      </div>
      <div class="event-item">
        <div class="event-bar">
          <span class="event-name">Otro evento</span>
        </div>
        <span class="event-date">“fecha”</span>
        <button class="event-edit" title="Editar">✎</button>
      </div>
    </div>
  </section>

  <!-- Amigos -->
  <section id="amigos" class="tab-content">
    <h3>Amigos</h3>
    <div class="friends-grid">
      <div class="friend-card">
        <div class="avatar">
          <img src="{% static 'img/avatar-placeholder.png' %}" alt="Avatar amigo">
        </div>
        <h4>Carla Soto</h4>
        <p>@carli</p>
        <button class="btn-primary">👁 Ver perfil</button>
        <button class="btn-primary">🎁 Regalar</button>
      </div>
    </div>
  </section>

</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener("DOMContentLoaded", function(){
  const tabs = document.querySelectorAll(".profile-nav a");
  const sections = document.querySelectorAll(".tab-content");

  tabs.forEach(tab => {
    tab.addEventListener("click", e => {
      e.preventDefault();
      tabs.forEach(t => t.classList.remove("active"));
      sections.forEach(s => s.classList.remove("active"));
      tab.classList.add("active");
      const target = document.getElementById(tab.getAttribute("data-tab"));
      if (target) target.classList.add("active");
    });
  });
});
</script>
{% endblock %}
