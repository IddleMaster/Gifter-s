{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>{% block title %}Gifter’s{% endblock %}</title>

  <!-- Favicons -->
  <link rel="icon" href="{% static 'img/Gifters/favicongift.png' %}" type="image/png">
  <link rel="apple-touch-icon" href="{% static 'img/Gifters/logo-sin-letras.png' %}">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700;900&display=swap" rel="stylesheet">

  <!-- Vendor CSS (via STATIC_URL=/assets/) -->
  <link href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'vendor/bootstrap-icons/bootstrap-icons.css' %}" rel="stylesheet">
  <link href="{% static 'vendor/aos/aos.css' %}" rel="stylesheet">
  <link href="{% static 'vendor/glightbox/css/glightbox.min.css' %}" rel="stylesheet">
  <link href="{% static 'vendor/swiper/swiper-bundle.min.css' %}" rel="stylesheet">

  <!-- Main CSS -->
  <link href="{% static 'css/main.css' %}" rel="stylesheet">
  <link href="{% static 'css/gifters.css' %}" rel="stylesheet">
  <link href="{% static 'css/perfil.css' %}" rel="stylesheet">

  <style>
    /* Poppins global */
    body,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    p,
    a,
    button {
      font-family: 'Poppins', sans-serif !important;
    }

    /* Igual que en tu index */
    .logo-img {
      height: 64px;
      width: auto;
      display: block;
    }

    .login-btn-standalone {
      display: inline-block;
      padding: .55rem 1rem;
      border-radius: 999px;
      background: #1970ea;
      color: #fff;
      text-decoration: none;
      font-weight: 700;
    }

    .login-btn-standalone:hover {
      filter: brightness(.92);
      color: #fff;
    }
  </style>
  <link href="{% static 'css/gifters.css' %}" rel="stylesheet">

  {% block extra_css %}{% endblock %}
</head>

<body class="{% block body_class %}{% endblock %}">

  <!-- HEADER = el mismo del index -->
  <header id="header" class="header sticky-top">

    <!-- Topbar -->
    <div class="topbar d-flex align-items-center">
      <div class="container d-flex justify-content-center justify-content-md-between">
        <div class="w-100 text-center py-1 bg-primary text-white">
          <i><span>Gifter's® 2025</span></i>
        </div>
        <div class="social-links d-none d-md-flex align-items-center">
          <a href="#" class="twitter"><i class="bi bi-twitter-x"></i></a>
          <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
          <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
          <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
        </div>
      </div>
    </div>

    <!-- Barra principal -->
    <div class="branding d-flex align-items-center">
      <div class="container position-relative d-flex align-items-center" style="min-height:84px;">

        <!-- IZQUIERDA: Marca + buscador (desktop) -->
        <div class="brand-left d-flex align-items-center gap-3 flex-shrink-0">
          <a href="{% url 'home' %}" class="logo brand d-flex align-items-center" style="z-index:2;">
            <span class="brand-text">Gifter’s</span>
            <img src="{% static 'img/Gifters/favicongift.png' %}" alt="Isotipo Gifter’s" class="brand-mark">
          </a>

          <!-- Buscador solo en ≥ LG -->
          <form class="site-search d-none d-lg-block" role="search" action="{% url 'productos_list' %}" method="get">
            <div class="input-group search-pill">
              <input type="search" class="form-control search-input" name="q"
                placeholder="Búsqueda: regalos, categorías, amigos..." aria-label="Buscar" value="{{ request.GET.q }}">
              <button class="btn btn-search" type="submit" aria-label="Buscar">
                <i class="bi bi-search"></i>
              </button>
            </div>
          </form>
        </div>

        <!-- CENTRO: Nav (solo desktop) -->
        <nav id="navmenu" class="navmenu d-none d-lg-block mx-auto">
          <ul>
            <li><a href="{% url 'home' %}#hero" class="active">Inicio</a></li>
            <li><a href="{% url 'home' %}#clients">Categorías</a></li>
            <li><a href="{% url 'home' %}#services">Amigos</a></li>
            <li><a href="{% url 'home' %}#portfolio">Regalos</a></li>
          </ul>
          <!-- <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>-->
          <i class="mobile-nav-toggle d-none"></i>
        </nav>

        <!-- DERECHA: Login + botones móviles -->
        <div class="d-flex align-items-center ms-auto">
          {% if user.is_authenticated %}
          <a href="{% url 'account_logout' %}" class="btn btn-primary">Cerrar sesión</a>
          {% else %}
          <a href="{% url 'account_login' %}" class="login-btn-standalone">Iniciar Sesión</a>
          {% endif %}



          <!-- Toggle buscador móvil -->
          <button class="btn btn-link p-0 ms-2 d-lg-none" type="button" data-bs-toggle="collapse"
            data-bs-target="#mobileSearch" aria-expanded="false" aria-controls="mobileSearch" aria-label="Buscar">
            <i class="bi bi-search" style="font-size:1.35rem;"></i>
          </button>

          <!-- Toggle menú móvil -->
          <button class="btn btn-link p-0 ms-2 d-lg-none" type="button" data-bs-toggle="collapse"
            data-bs-target="#mobileNav" aria-expanded="false" aria-controls="mobileNav" aria-label="Menú">
            <i class="bi bi-list" style="font-size:1.6rem;"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Agrupador de colapsables móviles -->
    <div id="mobileCollapses" class="d-lg-none">

      <!-- Buscador móvil colapsable -->
      <div id="mobileSearch" class="collapse border-top bg-white" data-bs-parent="#mobileCollapses">
        <div class="container py-2">
          <form class="site-search-mobile" role="search" action="{% url 'productos_list' %}" method="get">
            <div class="input-group search-pill">
              <input type="search" class="form-control search-input" name="q"
                placeholder="Buscar regalos, categorías, amigos…" aria-label="Buscar" value="{{ request.GET.q }}">
              <button class="btn btn-search" type="submit" aria-label="Buscar">
                <i class="bi bi-search"></i>
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Menú móvil colapsable -->
      <div id="mobileNav" class="collapse border-top bg-white" data-bs-parent="#mobileCollapses">
        <div class="container py-2">
          <nav aria-label="Navegación principal móvil">
            <ul class="nav flex-column mobile-nav">
              <li class="nav-item"><a class="nav-link" href="{% url 'home' %}#hero">Inicio</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'home' %}#clients">Categorías</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'home' %}#services">Amigos</a></li>
              <li class="nav-item"><a class="nav-link" href="{% url 'home' %}#portfolio">Regalos</a></li>
            </ul>
          </nav>
        </div>
      </div>

    </div>

    <!-- OPCIONAL: no se pisan buscador y menú; cerrar menú al click -->

  </header>
  <!-- /HEADER -->

  <main class="main">
    {% block content %}{% endblock %}
  </main>

  <!-- FOOTER (puedes reemplazar por el tuyo si prefieres) -->
  <footer id="footer" class="footer">
    <div class="container footer-top">
      <div class="row gy-4">
        <div class="col-lg-4 col-md-6 footer-about">
          <a href="{% url 'home' %}" class="d-flex align-items-center">
            <span class="sitename">Gifter's</span>
          </a>
          <div class="footer-contact pt-3">
            <p>Viena 998</p>
            <p>New York, NY 535022</p>
            <p class="mt-3"><strong>Teléfono:</strong> <span>+1 234 567 8900</span></p>
            <p><strong>Email:</strong> <span>info@gifters.com</span></p>
          </div>
        </div>
        <div class="col-lg-2 col-md-3 footer-links">
          <h4>Enlaces útiles</h4>
          <ul>
            <li><i class="bi bi-chevron-right"></i> <a href="{% url 'home' %}">Inicio</a></li>
            <li><i class="bi bi-chevron-right"></i> <a href="#">Acerca de</a></li>
            <li><i class="bi bi-chevron-right"></i> <a href="{% url 'ayuda' %}">Contáctanos</a></li>
          </ul>
        </div>
        <div class="col-lg-4 col-md-12">
          <h4>Síguenos</h4>
          <div class="social-links d-flex">
            <a href=""><i class="bi bi-twitter-x"></i></a>
            <a href=""><i class="bi bi-facebook"></i></a>
            <a href=""><i class="bi bi-instagram"></i></a>
            <a href=""><i class="bi bi-linkedin"></i></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center">
    <i class="bi bi-arrow-up-short"></i>
  </a>

  <!-- Vendor JS (vía STATIC_URL) -->
  <script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'vendor/php-email-form/validate.js' %}"></script>
  <script src="{% static 'vendor/aos/aos.js' %}"></script>
  <script src="{% static 'vendor/glightbox/js/glightbox.min.js' %}"></script>
  <script src="{% static 'vendor/waypoints/noframework.waypoints.js' %}"></script>
  <script src="{% static 'vendor/purecounter/purecounter_vanilla.js' %}"></script>
  <script src="{% static 'vendor/swiper/swiper-bundle.min.js' %}"></script>
  <script src="{% static 'vendor/imagesloaded/imagesloaded.pkgd.min.js' %}"></script>
  <script src="{% static 'vendor/isotope-layout/isotope.pkgd.min.js' %}"></script>

  <!-- Main JS -->
  <script src="{% static 'js/main.js' %}"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Elementos
      const msEl = document.getElementById('mobileSearch');
      const mnEl = document.getElementById('mobileNav');
      const bSearch = document.getElementById('btnMobileSearch');
      const bMenu = document.getElementById('btnMobileNav');

      // Si falta algo, salimos
      if (!window.bootstrap || !msEl || !mnEl || !bSearch || !bMenu) return;

      // Instancias de Collapse sin auto-toggle
      const ms = new bootstrap.Collapse(msEl, { toggle: false });
      const mn = new bootstrap.Collapse(mnEl, { toggle: false });

      // Evitar propagación/accidentes con otros listeners
      function stop(e) { e.preventDefault(); e.stopPropagation(); }

      // Clicks controlados: al abrir uno, cerramos el otro
      bSearch.addEventListener('click', function (e) {
        stop(e);
        mn.hide();
        ms.toggle();
      });

      bMenu.addEventListener('click', function (e) {
        stop(e);
        ms.hide();
        mn.toggle();
      });

      // Redundante (pero seguro): si uno se abre por otra causa, cierra el otro
      msEl.addEventListener('show.bs.collapse', function () { mn.hide(); });
      mnEl.addEventListener('show.bs.collapse', function () { ms.hide(); });

      // Cierra el menú al elegir una opción
      document.querySelectorAll('#mobileNav .nav-link').forEach(function (a) {
        a.addEventListener('click', function () {
          mn.hide();
        });
      });
    });
  </script>
  {% block extra_js %}{% endblock %}
</body>

</html>